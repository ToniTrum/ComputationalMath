\documentclass[a4paper,14pt]{extarticle}

\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[a4paper, margin=2.5cm]{geometry}
\usepackage{setspace}

\doublespacing

\begin{document}
    \begin{center}
        \textbf{Построение сплайна через моменты}
    \end{center}

    Введём обозначения: \\
    $\displaystyle 
    S''(x_i) = M_i, i = \overline{0, n} \\
    S(x) = y_i + c_i (x - x_i) + a_i \frac{(x - x_i)^2}{2} + b_i \frac{(x - x_i)^3}{6}, i = \overline{0, n - 1} \\
    S'(x) = c_i + a_i (x - x_i) + b_i \frac{(x - x_i)^2}{2}, i = \overline{0, n - 1} \\
    S''(x) = a_i + b_i (x - x_i), i = \overline{0, n - 1} \\
    S''(x_i) = a_i = M_i,\,\, S''(x_{i + 1}) = a_i + b_i h_{i + 1} = M_{i + 1} \\
    \\
    \fbox{$\displaystyle b_i = \frac{M_{i + 1} - M_i}{h_{i + 1}}$} \\
    \\
    S(x_{i + 1}) = y_i + c_i h_{i + 1} + a_i \frac{h_{i + 1}^2}{2} + b_i \frac{h_{i + 1}^3}{6} = y_{i + 1} \\
    c_i = \frac{y_{i + 1} - y_i}{h_{i + 1}} - M_i \frac{h_{i + 1}^2}{2 h_{i + 1}} - \frac{(M_{i + 1} - M_i) h_{i + 1}^3}{h_{i + 1} 6 h_{i + 1}} \\
    \\
    \fbox{$\displaystyle c_i = \frac{y_{i + 1} - y_i}{h_{i + 1}} - \frac{h_{i + 1}}{6} (M_{i + 1} + 2 M_i)$} \\
    \\
    S'(x) = c_i + a_i (x - x_i) + b_i \frac{(x - x_i)^2}{2}, x \in [x_i; x_{i + 1}] \\
    S'(x) = c_{i - 1} + a_{i - 1} (x - x_{i - 1}) + b_{i - 1} \frac{(x - x_{i - 1})^2}{2}, x \in [x_{i - 1}; x_i] \\
    S'(x_i - 0) = S'(x_i + 0) \\
    c_{i - 1} + a_{i - 1} h_i + b_{i - 1} \frac{h_i^2}{2} = c_i \\
    \frac{y_i - y_{i - 1}}{h_i} - \frac{h_i}{6} (M_i + 2 M_{i - 1}) + M_{i - 1} h_i + \frac{M_i - M_{i - 1}}{h_i} \frac{h_i^2}{2} = \frac{y_{i + 1} - y_i}{h_{i + 1}} - \frac{h_{i + 1}}{6} (M_{i + 1} + 2 M_i) \\
    \frac{h_{i + 1}}{6} (M_{i + 1} + 2 M_i) - \frac{h_i}{6} (M_i + 2 M_{i - 1}) + M_{i - 1} h_i + \frac{h_i}{2} (M_i - M_{i - 1}) = \frac{y_{i + 1} - y_i}{h_{i + 1}} - \left. \frac{y_i - y_{i - 1}}{h_i} \, \right| \times 6 \\
    h_i M_{i - 1} + 2 M_i (h_{i + 1} + h_i) + h_{i + 1} M_{i + 1} = 6 \left( \frac{y_{i + 1} - y_i}{h_{i + 1}} - \frac{y_i - y_{i - 1}}{h_i} \right) \, \left| \times \frac{1}{h_i + h_{i + 1}} \right. \\
    \mu_i = \frac{h_{i + 1}}{h_i + h_{i + 1}}; \lambda_i = \frac{h_i}{h_i + h_{i + 1}}; \lambda_i + \mu_i = 1 \\
    \\
    \fbox{$\displaystyle \lambda_i M_{i - 1} + 2 M_i + \mu_i M_{i + 1} = \underbrace{6 \left( \mu_i \frac{y_{i + 1} - y_i}{h_{i + 1}^2} - \lambda_i \frac{y_i - y_{i - 1}}{h_i^2} \right)}_{\displaystyle g_i} $} \\
    \\
    i = \overline{1, n - 1}; M_0, M_1, \ldots, M_{n - 1}, M_n
    $

    \textbf{Краевые условия:} \\
    $\displaystyle 
    1) S'(a) = f'(a), S'(b) = f'(b); \\
    S'(a) = c_0 + a_0 (a - x_0) + b_0 \frac{(a - x_0)^2}{2} = c_0 = \frac{y_1 - y_0}{h_1} - \frac{h_1}{6} (M_1 + 2 M_0) = f'(a) \\
    2 M_0 + M_1 = \underbrace{6 \frac{y_1 - y_0}{h_1} - \frac{6}{h_1} f'(a)}_{\displaystyle g_0} \\
    S'(b) = c_{n - 1} + a_{n - 1} (b - x_{n - 1}) + b_{n - 1} \frac{(b - x_{n - 1})^2}{2} = c_{n - 1} + a_{n - 1} h_n + b_{n - 1} \frac{h_n^2}{2} = \frac{y_n - y_{n - 1}}{h_n} - \frac{h_n}{6} (M_n + 2 M_{n - 1}) + h_n M_{n - 1} + \frac{M_n - M_{n - 1}}{h_n} \frac{h_n^2}{2} = f'(b) \\
    M_{n - 1} + 2 M_n = \underbrace{\frac{6}{h_n} f'(b) - 6 \frac{y_n - y_{n - 1}}{h_n^2}}_{\displaystyle g_n} \\
    \left( \begin{array}{cccccccc}
        2 & 1 & 0 & 0 & \cdots & 0 & 0 & 0 \\
        \lambda_1 & 2 & \mu_1 & 0 & \cdots & 0 & 0 & 0 \\
        0 & \lambda_2 & 2 & \mu_2 & \cdots & 0 & 0 & 0 \\
        \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
        0 & 0 & 0 & 0 & \cdots & \lambda_{n - 1} & 2 & \mu_{n - 1} \\
        0 & 0 & 0 & 0 & \cdots & 0 & 1 & 2
    \end{array} \right) \left( \begin{array}{c}
        M_0 \\ M_1 \\ M_2 \\ \vdots \\ M_{n - 1} \\ M_n
    \end{array} \right) = \left( \begin{array}{c}
        g_0 \\ g_1 \\ g_2 \\ \vdots \\ g_{n - 1} \\ g_n
    \end{array} \right) \\
    \\
    3) S''(a) = f''(a), S''(b) = f''(b); \\
    M_0 = f''(a), M_n = f''(b) \\
    \left( \begin{array}{cccccccc}
        1 & 0 & 0 & 0 & \cdots & 0 & 0 & 0 \\
        \lambda_1 & 2 & \mu_1 & 0 & \cdots & 0 & 0 & 0 \\
        0 & \lambda_2 & 2 & \mu_2 & \cdots & 0 & 0 & 0 \\
        \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
        0 & 0 & 0 & 0 & \cdots & \lambda_{n - 1} & 2 & \mu_{n - 1} \\
        0 & 0 & 0 & 0 & \cdots & 0 & 0 & 1
    \end{array} \right) \left( \begin{array}{c}
        M_0 \\ M_1 \\ M_2 \\ \vdots \\ M_{n - 1} \\ M_n
    \end{array} \right) = \left( \begin{array}{c}
        f''(a) \\ g_1 \\ g_2 \\ \vdots \\ g_{n - 1} \\ f''(b)
    \end{array} \right) \\
    \\
    5) f(a) = f(b), f(x_{n + 1}) = f(x_1), \ldots \\
    M_0 = M_n, M_{n + 1} = M_1, \ldots \\
    h_{n + 1} = h_1, h_{n + 2} = h_2, \ldots \\
    \mu_{n + 1} = \mu_1, \ldots \\
    i = 1: \\
    \lambda_1 M_0 + 2 M_1 + M_2 = g_1 \\
    2 M_1 + \mu_1 M_2 + \lambda_1 M_n = g_1 \\
    i = n: \\
    \lambda_n M_{n - 1} + 2 M_n + \mu_n M_{n + 1} = g_n \\
    \mu_n M_1 + \lambda_n M_{n - 1} + 2 M_n = g_n \\
    \left( \begin{array}{cccccccc}
        2 & \mu_1 & 0 & 0 & \cdots & 0 & 0 & \lambda_1 \\
        \lambda_2 & 2 & \mu_2 & 0 & \cdots & 0 & 0 & 0 \\
        0 & \lambda_3 & 2 & \mu_3 & \cdots & 0 & 0 & 0 \\
        \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
        0 & 0 & 0 & 0 & \cdots & \lambda_{n - 1} & 2 & \mu_{n - 1} \\
        \mu_n & 0 & 0 & 0 & \cdots & 0 & \lambda_n & 2
    \end{array} \right) \left( \begin{array}{c}
        M_1 \\ M_2 \\ M_3 \\ \vdots \\ M_{n - 1} \\ M_n
    \end{array} \right) = \left( \begin{array}{c}
        g_1 \\ g_2 \\ g_3 \\ \vdots \\ g_{n - 1} \\ g_n
    \end{array} \right) \\
    \\
    6) S'''(x_1 + 0) = S'''(x_1 - 0), S'''(x_{n - 1} + 0) = S'''(x_{n - 1} - 0); \\
    S'''(x) = b_i, x \in [x_i; x_{i + 1}] \\
    b_0 = b_1 \\
    \frac{M_1 - M_0}{h_1} = \left. \frac{M_2 - M_1}{h_2}\, \right| \times h_1 \\
    \gamma_1 = \frac{h_1}{h_2} \\
    M_0 - M_1 (1 + \gamma_1) + \gamma_1 M_2 = 0 \\
    i = 1:\, \lambda_1 M_0 + 2 M_1 + \mu_1 M_2 = 6 \left( \mu_1 \frac{y_2 - y_1}{h_2^2} - \lambda_1 \frac{y_1 - y_0}{h_1^2} \right) \\
    M_0 - M_1 (1 + \gamma_1) + \gamma_1 M_2 = 0\, | \times \lambda_1 \\
    M_2 (\mu_1 \gamma_1^2 - \mu_1) - M_1 (\lambda_1 + \lambda_1 \gamma_1 + 2) = -6 \left( \mu_1 \frac{y_2 - y_1}{h_2^2} - \lambda_1 \frac{y_1 - y_0}{h_1^2} \right) \\
    -\lambda_1 - \lambda_1 \gamma_1 - 2 = -\lambda_1 (1 + \gamma_1) - 2 = -\frac{h_1}{h_2 + h_1} \frac{h_2 + h_1}{h_2} - 2 = -\gamma_1 - 2 \\
    M_1 (-\gamma_1 - 2) + M_2 (\mu_1 \gamma_1^2 - \mu_1) = \underbrace{-6 \left( \mu_1 \frac{y_2 - y_1}{h_2^2} - \lambda_1 \frac{y_1 - y_0}{h_1^2} \right)}_{\displaystyle \widehat{g}_1} \\
    b_{n - 2} = b_{n - 1} \\
    \frac{M_{n - 1} - M_{n - 2}}{h_{n - 1}} = \left. \frac{M_n - M_{n - 1}}{h_n}\, \right| \times h_n \\
    \gamma_n = \frac{h_n}{h_{n - 1}} \\
    \gamma_n M_{n - 2} - M_{n - 1} (1 + \gamma_n) + M_n = 0 \\
    i = n - 1:\, \lambda_{n - 1} M_{n - 2} + 2 M_{n - 1} + \mu_{n - 1} M_n = 6 \left( \mu_{n - 1} \frac{y_n - y_{n - 1}}{h_n^2} - \lambda_{n - 1} \frac{y_{n - 1} - y_{n - 2}}{h_{n - 1}^2} \right) \\
    \gamma_n M_{n - 2} - M_{n - 1} (1 + \gamma_n) + M_n = 0\, | \times \mu_{n - 1} \\
    M_{n - 2} (\lambda_{n - 1} \gamma_n^2 - \lambda_{n - 1}) - M_{n - 1} (\mu_{n - 1} \gamma_n + \mu_{n - 1} + 2) = -6 \left( \mu_{n - 1} \frac{y_n - y_{n - 1}}{h_n^2} \right. \\ \left. - \lambda_{n - 1} \frac{y_{n - 1} - y_{n - 2}}{h_{n - 1}^2} \right) \\
    -\mu_{n - 1} - \mu_{n - 1} \gamma_n - 2 = \mu_{n - 1} (1 + \gamma_n) - 2 = -\frac{h_n}{h_n + h_{n - 1}} \frac{h_n + h_{n - 1}}{h_{n - 1}} - 2 = -\gamma_n - 2 \\
    M_{n - 2} (\lambda_{n - 1} \gamma_n^2 - \lambda_{n - 1}) + M_1 (-\gamma_n - 2) = \underbrace{-6 \left( \mu_{n - 1} \frac{y_n - y_{n - 1}}{h_n^2} - \lambda_{n - 1} \frac{y_{n - 1} - y_{n - 2}}{h_{n - 1}^2} \right)}_{\displaystyle \widehat{g}_{n - 1}} \\
    \left( \begin{array}{cccccccc}
        -\gamma_1 - 2 & \mu_1 \gamma_1^2 - \mu_1 & 0 & 0 & \cdots & 0 & 0 & 0 \\
        \lambda_2 & 2 & \mu_2 & 0 & \cdots & 0 & 0 & 0 \\
        0 & \lambda_3 & 2 & \mu_3 & \cdots & 0 & 0 & 0 \\
        \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\
        0 & 0 & 0 & 0 & \cdots & \lambda_{n - 2} & 2 & \mu_{n - 2} \\
        0 & 0 & 0 & 0 & \cdots & 0 & \lambda_{n - 1} \gamma_n^2 - \lambda_{n - 1} & -\gamma_n - 2
    \end{array} \right) \left( \begin{array}{c}
        M_1 \\ M_2 \\ M_3 \\ \vdots \\ M_{n - 2} \\ M_{n - 1}
    \end{array} \right) = \left( \begin{array}{c}
        \widehat{g}_1 \\ g_2 \\ g_3 \\ \vdots \\ g_{n - 2} \\ \widehat{g}_{n - 1}
    \end{array} \right) \\$

\end{document}